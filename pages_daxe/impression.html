<!DOCTYPE html>
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Daxe : Page for printing</title>
<link href="../interface/nuages/style.css" rel="stylesheet" type="text/css">
</head>
<body>
<h1>Daxe</h1>
<ul>
<li>Daxe configuration files<ul>
<li>Introduction</li>
<li>Definition of the XML language</li>
<li>File saving options</li>
<li>Menus</li>
<li>Node display</li>
<li>Display types</li>
<li>Strings</li>
</ul>
</li>
<li>CMS integration<ul>
<li>Introduction</li>
<li>Launching Daxe</li>
<li>Saving files</li>
<li>Directory listing</li>
</ul>
</li>
<li>Extending Daxe<ul>
<li>Introduction</li>
<li>Creating a new extension</li>
<li>Creating new display types</li>
<li>More customization</li>
</ul>
</li>
</ul>
<hr>
<div style="page-break-after: always"></div>
<h1>Index</h1>
<div class="zone_texte">

<div class="section_normale">
<h2>Daxe</h2>

<p>Daxe is an XML editor for the web. It works in the same way as <a target="_blank" class="lien" href="http://jaxe.sourceforge.net/en/">Jaxe</a>, using an XML schema and a configuration file to define the XML language and the editor UI. A number of common element displays are provided with Daxe to make it easy to create a new editor UI for any XML language.</p>

<p>Daxe is written in <a target="_blank" class="lien" href="https://www.dartlang.org/">Dart</a>, which is transformed into Javascript to work in modern web browsers (it does not work on IE before version 9). As with any Javascript application, it works without the need for a plugin.</p>

<p>In itself, Daxe is not very useful, because it cannot open or save a local file (because of browser restrictions). It needs to be either used with the <a target="_blank" class="lien" href="https://github.com/adopt/daxapp">Daxe desktop application</a>, or included into a larger system like a CMS. Daxe is now integrated into <a target="_blank" class="lien" href="http://media4.obspm.fr/outils/webjaxe/en/">WebJaxe</a>, and will soon be used in <a target="_blank" class="lien" href="http://www.lon-capa.org/">LON-CAPA</a>.</p>

</div>

<div class="section_normale">
<h2>Demo</h2>

<ul>
<li>

<a target="_blank" class="lien" href="http://adopt.github.io/daxe/demo/daxe.html?config=config/XHTML_config.xml">New XHTML 1.0 document</a>

</li>
<li>

<a target="_blank" class="lien" href="http://adopt.github.io/daxe/demo/daxe.html?config=config/XHTML5_config.xml">New XHTML 5 document</a>

</li>
<li>

<a target="_blank" class="lien" href="http://adopt.github.io/daxe/demo/daxe.html?config=config/XPAGES_config.xml">New XPAGES document</a>

</li>
<li>

<a target="_blank" class="lien" href="http://adopt.github.io/daxe/demo/daxe.html?config=config/XMLSchema_config.xml&amp;file=config/XHTML5.xsd">XHTML5 schema</a>

</li>
</ul>

</div>

<div class="section_normale">
<h2>Using Daxe</h2>

<p>
An XML file can easily be opened in Daxe with the following parameters:
</p>

<ul>
<li>

<span class="code">config</span>: the path to the configuration file (required)</li>
<li>

<span class="code">file</span>: the path to the file to be edited (optional, a new document is created if it is not specified)</li>
</ul>

<p>
To integrate Daxe into a larger system and make it possible to save documents, see <a class="lien" href="../pages_integration/introduction.html">CMS integration</a>.
</p>

</div>

<div class="section_normale">
<h2>Building and testing</h2>

<ul>
<li>Get the code from <a target="_blank" class="lien" href="https://github.com/adopt/daxe">Daxe on github</a>

</li>
<li>Install the <a target="_blank" class="lien" href="https://www.dartlang.org/tools/sdk/">Dart SDK</a>.</li>
<li>

<span class="code">./build.sh</span> (or just <span class="code">pub build</span> with <span class="code">pub</span> on the PATH)</li>
<li>copy the <span class="code">build/web</span> directory on a server (here localhost, with the contents of <span class="code">build/web</span> inside a <span class="code">daxe</span> directory)</li>
<li>run with the URL <span class="code">http://localhost/daxe/daxe_js.html?config=config/XPAGES_config.xml</span>

</li>
</ul>

</div>

<div class="section_normale">
<h2>Precompiled version</h2>

<p>
If you have trouble compiling (the Dart SDK is not available on all platforms), you can use this precompiled version, but it will not be up-to-date.
</p>

<p>

<a target="_blank" class="lien" href="daxe.zip">daxe.zip</a>

</p>

</div>

<div class="section_normale">
<h2>Documentation</h2>

<ul>
<li>

<a class="lien" href="../pages_doc-config-en/intro-doc-config-en.html">Daxe configuration files</a>

</li>
<li>

<a class="lien" href="../pages_integration/introduction.html">CMS integration</a>

</li>
<li>

<a class="lien" href="../pages_extension/introduction.html">Extending Daxe</a>

</li>
</ul>

</div>

<div class="section_normale">
<h2>Licence</h2>

<p>
Daxe is licenced under the <a target="_blank" class="lien" href="http://www.gnu.org/licenses/gpl-3.0.en.html">GPL version 3</a> or later.
</p>

</div>

</div>
<div class="spacer"></div>
<hr>
<div style="page-break-after: always"></div>
<h1>Daxe configuration files</h1>
<hr>
<h1>Introduction</h1>
<div class="zone_texte">
    
<p>To provide a user interface for a given XML language, Daxe needs the language definition (given with an XML schema) and a configuration file describing the user interface for the language. It works in the same way as <a target="_blank" class="lien" href="http://jaxe.sourceforge.net/en/">Jaxe</a>, but the config files use a different language. An XSLT stylesheet is available in the <span class="code">config</span> directory to transform a Jaxe configuration file into a Daxe one.</p>
    
<p>Specifically, configuration files contain basic information about the XML language (a link to the schema and a list of root elements), saving options, menus (especially to insert the elements), display types for the elements, and all the strings used in the interface, depending on the user language.</p>
    
<p>They are located in Daxe's <span class="code">config</span> directory, and their names end with "_config.xml".</p>
  
</div>
<div class="spacer"></div>
<hr>
<h1>Definition of the XML language</h1>
<div class="zone_texte">
    
<div class="section_normale">
<h2>Element definition</h2>
      
<ul>
<li>

<span class="code">XML schema file</span>

<p>When creating a new config file, the first thing to do is to define the corresponding XML language. This is usually done by specifying an existing XML schema. Schemas must use the W3C syntax (WXS), or the Relax NG one (in XML).</p>
        
</li>
<li>

<span class="code">Root</span>

<p>After defining the XML language, it is necessary to give Jaxe one or several possible root elements to use for new documents. The name of the element is specified for each possible root element.</p>
        
</li>
</ul>
    
</div>
    
<div class="section_normale">
<h2>Element tree</h2>
      
<p>Element tree under <span class="code">Language</span> :</p>
      
<ul>
<li>

<span class="code">Language (XML schema file, Root+)</span>

<ul>
<li>

<span class="code">XML schema file @name</span>

</li>
<li>

<span class="code">Root @element</span>

</li>
</ul>
        
</li>
</ul>
    
</div>
  
</div>
<div class="spacer"></div>
<hr>
<h1>File saving options</h1>
<div class="zone_texte">
    
<div class="section_normale">
<h2>Element definition</h2>
      
<ul>
<li>

<span class="code">Doctype</span>

<p>Document type definition, if a DTD must be specified in the document headers.</p>
        
</li>
<li>

<p>

<span class="code">SchemaLocation</span>

</p>
          
<p>To save the location of the XML schema in XML documents.</p>
        
</li>
<li>

<span class="code">Namespace prefix</span>

<p>Prefix to use for a given namespace. It is possible to specify several namespace prefixes.</p>
        
</li>
</ul>
    
</div>
    
<div class="section_normale">
<h2>Element tree</h2>
      
<p>Element tree under <span class="code">Saving</span> :</p>
      
<ul>
<li>

<span class="code">Saving (Doctype?, Namespace prefix*)</span>

<ul>
<li>

<span class="code">Doctype @publicid @systemid</span>

</li>
<li>

<span class="code">SchemaLocation @schemaLocation @noNamespaceSchemaLocation</span>

</li>
<li>

<span class="code">Namespace prefix @uri @prefix</span>

</li>
</ul>
        
</li>
</ul>
    
</div>
  
</div>
<div class="spacer"></div>
<hr>
<h1>Menus</h1>
<div class="zone_texte">
    
<p>Menus defined in config files are displayed above Daxe's text area, after the file and edit menus.</p>
    
<div class="section_normale">
<h2>Element definition</h2>
      
<ul>
<li>

<span class="code">Menu</span>

<p>A main menu, possibly containing sub-menus.</p>
        
</li>
<li>

<span class="code">Insertion menu</span>

<p>A menu to insert an XML node at the cursor position. The node name and the node type (element by default) must be specified. It is also possible to specify a keyboard shortcut, with the corresponding key.</p>
        
</li>
<li>

<span class="code">Function menu</span>

<p>Menu to execute a <em>function</em> with its name. The only predefined function in Jaxe is <span class="code">jaxe.FonctionNormal</span>, which is used to remove all the styles in a text area. Other functions can be added by extending Daxe.</p>
        
</li>
<li>

<span class="code">Separator</span>

<p>Menu separator.</p>
        
</li>
</ul>
    
</div>
    
<div class="section_normale">
<h2>Element tree</h2>
      
<p>Element tree under <span class="code">Menus</span> :</p>
      
<ul>
<li>

<span class="code">Menus (Menu+)</span>

<ul>
<li>

<span class="code">Menu @nom (Menu | Insertion menu | Function menu | Separator)+</span>

<ul>
<li>

<span class="code">Insertion menu @name @node type (element|instruction|comment) @shortcut</span>

</li>
<li>

<span class="code">Function menu @name @class @shortcut</span>

<ul>
<li>

<span class="code">Parameter @name @value</span>

</li>
</ul>
                
</li>
<li>

<span class="code">Separator</span>

</li>
<li>

<span class="code">Menu</span>

</li>
</ul>
            
</li>
</ul>
        
</li>
</ul>
    
</div>
  
</div>
<div class="spacer"></div>
<hr>
<h1>Node display</h1>
<div class="zone_texte">
    
<p>An essential feature in Daxe is the possibility to display and edit XML element in different ways, whatever their types in the XML schema. For instance, a table element can be displayed as a table, and an element linking to an image can be displayed as an image. The objective is to ease document editing, without losing of sight their semantics&nbsp;: elements will not be displayed as they will be seen in web pages or PDF documents, but simply with a user interface making edition easier and highlighting the meaning of the elements.</p>
    
<div class="section_normale">
<h2>Element definition</h2>
      
<ul>
<li>

<span class="code">Element display</span>

<p>Specifies how an element will be displayed in Jaxe</p>
        
</li>
<li>

<span class="code">Parameter</span>

<p>A display parameter, depending on the display type (see below for a list).</p>
        
</li>
<li>

<span class="code">Suggested value</span>

<p>Value suggested to the user when the schema does not limit authorized values.</p>
        
</li>
<li>

<span class="code">Attribute display</span>

<p>Can be used to suggest attribute values.</p>
        
</li>
</ul>
    
</div>
    
<div class="section_normale">
<h2>Element tree</h2>
      
<p>Element tree under <span class="code">Display</span> :</p>
      
<ul>
<li>

<span class="code">Display (Element display)+</span>

<ul>
<li>

<span class="code">Element display @element @type (Parameter | Suggested value | Attribute display)*</span>

<ul>
<li>

<span class="code">Parameter @name @value</span>

</li>
<li>

<span class="code">Suggested value</span>

</li>
<li>

<span class="code">Attribute display @attribute (Suggested value+)</span>

<ul>
<li>

<span class="code">Suggested value</span>

</li>
</ul>
                
</li>
</ul>
            
</li>
</ul>
        
</li>
</ul>
    
</div>
  
</div>
<div class="spacer"></div>
<hr>
<h1>Display types</h1>
<div class="zone_texte">
    
<table class="tableau">
      
<tr>

<th>Type</th>
<th>Description</th>
<th>Display</th>

</tr>
      
<tr>

<td class="tableaux1">
<span class="code">division</span>
</td>
<td class="tableaux1">Two bars extending to the window's right side, clearly separating large areas in the document.</td>
<td class="tableaux1">
<img src="../pages_doc-config-en/images_types/division.png" alt="images_types/division.png">
</td>

</tr>
      
<tr>

<td class="tableaux2">
<span class="code">area</span>
</td>
<td class="tableaux2">Two tags and carriage returns, to separate areas smaller than with <span class="code">division</span>.</td>
<td class="tableaux2">
<img src="../pages_doc-config-en/images_types/zone.png" alt="images_types/zone.png">
</td>

</tr>
      
<tr>

<td class="tableaux1">
<span class="code">block</span>
</td>
<td class="tableaux1">A block hiding the start and end tags, as an alternative to <span class="code">division</span> and <span class="code">area</span>. Attributes are displayed on top, in a short or editable view, and the block can be collapsed with a button.</td>
<td class="tableaux1">
<img src="../pages_doc-config-en/images_types/block.png" alt="images_types/block.png">
</td>

</tr>
      
<tr>

<td class="tableaux2">
<span class="code">string</span>
</td>
<td class="tableaux2">Two tags to identify a small string, without any carriage return.</td>
<td class="tableaux2">
<img src="../pages_doc-config-en/images_types/string.png" alt="images_types/string.png">
</td>

</tr>
      
<tr>

<td class="tableaux1">
<span class="code">empty</span>
</td>
<td class="tableaux1">A single tag, typically for an empty element.</td>
<td class="tableaux1">
<img src="../pages_doc-config-en/images_types/vide.png" alt="images_types/vide.png">
</td>

</tr>
      
<tr>

<td class="tableaux2">
<span class="code">table</span>
</td>
<td class="tableaux2">Table display allowing the use of XML elements inside the cells. Also handles the rowspan and colspan attributes to gather cells vertically and horizontally.</td>
<td class="tableaux2" rowspan="3">
<img src="../pages_doc-config-en/images_types/tabletexte.png" alt="images_types/tabletexte.png">
</td>

</tr>
      
<tr>

<td class="tableaux1">
<span class="code">tr</span>
</td>
<td class="tableaux1">Table row.</td>

</tr>
      
<tr>

<td class="tableaux2">
<span class="code">td</span>
</td>
<td class="tableaux2">Table cell.</td>

</tr>
      
<tr>

<td class="tableaux1">
<span class="code">style</span>
</td>
<td class="tableaux1">For use in the case (very rare if the XML language encodes the meaning as opposed to the presentation) where an XML element only conveys a style information. Displays the characters in the chosen style (bold, italic, ...), without any tag. An alternative is to use the <span class="code">string</span> type, which can also use a style, but displays the tags.</td>
<td class="tableaux1">
<img src="../pages_doc-config-en/images_types/style.png" alt="images_types/style.png">
</td>

</tr>
      
<tr>

<td class="tableaux2">
<span class="code">file</span>
</td>
<td class="tableaux2">Displays an image based on its path on the disk coming from an attribute of the XML element (to be defined). It is possible to copy/paste images and Daxe will automatically create the XML element and save the image file whenever possible, using the first element of type <span class="code">file</span>.</td>
<td class="tableaux2">
<img src="../pages_doc-config-en/images_types/fichier.png" alt="images_types/fichier.png">
</td>

</tr>
      
<tr>

<td class="tableaux1">
<span class="code">symbol</span>
</td>
<td class="tableaux1">Special character stored as a UNICODE character within the element tags. If no element has this type, users will still be able to insert UNICODE characters from a table.</td>
<td class="tableaux1">
<span class="symbole">&hArr;</span>
</td>

</tr>
      
<tr>

<td class="tableaux2">
<span class="code">list</span>
</td>
<td class="tableaux2">For an element representing a bulleted or ordered list. The sub-element must use the <span class="code">item</span> type. The tags are displayed as for <span class="code">area</span>, with a '+' button to create new items.</td>
<td class="tableaux2">
<img src="../pages_doc-config-en/images_types/liste.png" alt="images_types/liste.png">
</td>

</tr>
      
<tr>

<td class="tableaux1">
<span class="code">item</span>
</td>
<td class="tableaux1">List item in a list displayed with the <span class="code">list</span> type. Displayed with bullets or numbers, depending on the list type.</td>
<td class="tableaux1">
<img src="../pages_doc-config-en/images_types/item.png" alt="images_types/item.png">
</td>

</tr>
      
<tr>

<td class="tableaux2">
<span class="code">wlist</span>
</td>
<td class="tableaux2">Displays a list with the default browser display for the HTML <span class="code">ul</span> element. This provides a more WYSIWYG interface than <span class="code">list</span>, because the list tags are hidden (which might also make it harder to edit the XML precisely). The <span class="code">witem</span> type must be used for items.</td>
<td class="tableaux2">
<img src="../pages_doc-config-en/images_types/wlist.png" alt="images_types/wlist.png">
</td>

</tr>
      
<tr>

<td class="tableaux1">
<span class="code">witem</span>
</td>
<td class="tableaux1">Must be used for items in a list using the <span class="code">wlist</span> type.</td>
<td class="tableaux1">
<img src="../pages_doc-config-en/images_types/witem.png" alt="images_types/witem.png">
</td>

</tr>
      
<tr>

<td class="tableaux2">
<span class="code">simpletype</span>
</td>
<td class="tableaux2">Displays an element having a simple value, in a small panel. Usable only for the elements with a simple type in the XML schema. The precise display (text field, menu or checkbox) and the validation are done based on the XML schema constraints.</td>
<td class="tableaux2">
<img src="../pages_doc-config-en/images_types/typesimple.png" alt="images_types/typesimple.png">
</td>

</tr>
      
<tr>

<td class="tableaux1">
<span class="code">equationmem</span>
</td>
<td class="tableaux1">Displays the image of an equation. The equation can be edited by a simple click on the image, with a dialog showing at the same time the text of the equation (using a very simple <a class="lien" href="../pages_/equations.html">syntax</a> specific to Jaxe/Daxe) and the corresponding image. The text of the equation is store as an attribute, and the image is encoded in base64 and added as text inside the element.</td>
<td class="tableaux1">
<img class="maths" src="../pages_doc-config-en/equations_doc-config-en/equation1.png" alt="int(1/sqrt(x);x;1;infty)">
</td>

</tr>
      
<tr>

<td class="tableaux2">
<span class="code">equatexmem</span>
</td>
<td class="tableaux2">This works in the same way as the previous type, but using a TeX syntax.</td>
<td class="tableaux2">
<img src="../pages_doc-config-en/images_types/equatex.png" alt="images_types/equatex.png">
</td>

</tr>
      
<tr>

<td class="tableaux1">
<span class="code">form</span>
</td>
<td class="tableaux1">Displays an element and all its sub-elements as a form. Beware not to use this type with elements that could have an infinitely deep subtree !
          Sub-elements can be displayed as fields with the <span class="code">field</span> type, or with other types (using other types within a form is only possible with Daxe, not Jaxe).</td>
<td class="tableaux1">
<img src="../pages_doc-config-en/images_types/formulaire.png" alt="images_types/formulaire.png">
</td>

</tr>
      
<tr>

<td class="tableaux2">
<span class="code">field</span>
</td>
<td class="tableaux2">Form field</td>
<td class="tableaux2">see above</td>

</tr>
      
<tr>

<td class="tableaux1">
<span class="code">anchor</span>
</td>
<td class="tableaux1">This is used to display WYSIWYG links with the HTML <span class="code">a</span> element.</td>
<td class="tableaux1">
<img src="../pages_doc-config-en/images_types/anchor.png" alt="images_types/anchor.png">
</td>

</tr>
      
<tr>

<td class="tableaux2">
<span class="code">hiddenp</span>
</td>
<td class="tableaux2">Provides a WYSIWYG interface to paragraph elements. Tags are not displayed, and entering a newline where the paragraph element is allowed automatically triggers the insertion of a new paragraph.</td>
<td class="tableaux2">
<img src="../pages_doc-config-en/images_types/hiddenp.png" alt="images_types/hiddenp.png">
</td>

</tr>
      
<tr>

<td class="tableaux1">
<span class="code">hiddendiv</span>
</td>
<td class="tableaux1">Hides elements such as the HTML <span class="code">div</span> to provide a more WYSIWYG interface. A new menu appears in the contextual menu to remove a parent <span class="code">div</span>.</td>
<td class="tableaux1"></td>

</tr>
      
<tr>

<td class="tableaux2">
<span class="code">stylespan</span>
</td>
<td class="tableaux2">Normally used on an HTML <span class="code">span</span> element, this makes Daxe use the element with this type to add style to text. Note that it is better to provide semantic elements rather than style ones like <span class="code">span</span>.</td>
<td class="tableaux2"></td>

</tr>
      
<tr>

<td class="tableaux1">
<span class="code">hr</span>
</td>
<td class="tableaux1">Displayed as a horizontal line, as for the HTML <span class="code">hr</span> element.</td>
<td class="tableaux1">
<img src="../pages_doc-config-en/images_types/hr.png" alt="images_types/hr.png">
</td>

</tr>
      
<tr>

<td class="tableaux2">
<span class="code">br</span>
</td>
<td class="tableaux2">Displayed as a line break, as the HTML <span class="code">br</span> element. This display type might not play well with <span class="code">hiddenp</span>, and should be avoided in general.</td>
<td class="tableaux2"></td>

</tr>
    
</table>
    
<p>Parameters can be specified for some display types, with the <span class="code">Parameter</span> element under <span class="code">Element display</span>.</p>
    
<p>Display types <span class="code">division</span> and <span class="code">area</span> can have a parameter specifying the name of the attribute to use as a title for the element display.</p>
    
<p>Display types <span class="code">file</span> and <span class="code">symbol</span> <em>must</em> have a parameter specifying the attribute with the file name.</p>
    
<p>Display types <span class="code">table</span> <em>must</em> have parameters specifying the elements for the rows and the cells.</p>
    
<p>Display types <span class="code">style</span> <em>must</em> have a parameter specifying the style.</p>
    
<p>Display types <span class="code">area</span> and <span class="code">string</span> can have a parameter specifying the style, a parameter with the font family, and a parameter with the font size.</p>
    
<p>Display types <span class="code">equationmem</span> and <span class="code">equatexmem</span> <em>must</em> have a parameter specifying the attribute to use for the equation text.</p>
    
<p>Here is a list of all the parameters:</p>
    
<table class="tableau">
      
<tr>

<th>type</th>
<th>parameter name</th>
<th>description</th>

</tr>
      
<tr>

<td class="tableaux1">division and area</td>
<td class="tableaux1">titleAtt</td>
<td class="tableaux1">attribute for the title</td>

</tr>
      
<tr>

<td class="tableaux2">division, area, string and empty</td>
<td class="tableaux2">visibleAttributes</td>
<td class="tableaux2">displays all the attributes on the start tag (true|false)</td>

</tr>
      
<tr>

<td class="tableaux1">table</td>
<td class="tableaux1">colspanAttr</td>
<td class="tableaux1">attribute to merge columns</td>

</tr>
      
<tr>

<td class="tableaux2">table</td>
<td class="tableaux2">rowspanAttr</td>
<td class="tableaux2">attribute to merge rows</td>

</tr>
      
<tr>

<td class="tableaux1">table</td>
<td class="tableaux1">alignAttr</td>
<td class="tableaux1">attribute to align text</td>

</tr>
      
<tr>

<td class="tableaux2">wlist</td>
<td class="tableaux2">type</td>
<td class="tableaux2">type of list (<span class="code">ul|ol</span>) (unordered/ordered)</td>

</tr>
      
<tr>

<td class="tableaux1">style, area and string</td>
<td class="tableaux1">style</td>
<td class="tableaux1">
<span class="code">BOLD</span> | <span class="code">ITALIC</span> | <span class="code">SUPERSCRIPT</span> | <span class="code">SUBSCRIPT</span> | <span class="code">UNDERLINE</span> | <span class="code">STRIKETHROUGH</span> | <span class="code">FOREGROUND[###,###,###]</span> | <span class="code">BACKGROUND[###,###,###]</span>
</td>

</tr>
      
<tr>

<td class="tableaux2">area and string</td>
<td class="tableaux2">font</td>
<td class="tableaux2">font family</td>

</tr>
      
<tr>

<td class="tableaux1">area and string</td>
<td class="tableaux1">size</td>
<td class="tableaux1">font size</td>

</tr>
      
<tr>

<td class="tableaux2">file</td>
<td class="tableaux2">srcAtt</td>
<td class="tableaux2">attribute with the file name</td>

</tr>
      
<tr>

<td class="tableaux1">file</td>
<td class="tableaux1">chooser</td>
<td class="tableaux1">when set to "true", the file chooser is used to select a file, from the XML file directory</td>

</tr>
      
<tr>

<td class="tableaux2">file</td>
<td class="tableaux2">widthAtt</td>
<td class="tableaux2">the name of the attribute with the width (in pixels)</td>

</tr>
      
<tr>

<td class="tableaux1">file</td>
<td class="tableaux1">heightAtt</td>
<td class="tableaux1">the name of the attribute with the width (in pixels)</td>

</tr>
      
<tr>

<td class="tableaux2">item</td>
<td class="tableaux2">image1</td>
<td class="tableaux2">first bullet image</td>

</tr>
      
<tr>

<td class="tableaux1">item</td>
<td class="tableaux1">image2</td>
<td class="tableaux1">second bullet image</td>

</tr>
      
<tr>

<td class="tableaux2">equationmem and equatexmem</td>
<td class="tableaux2">textAtt</td>
<td class="tableaux2">attribute with the equation text</td>

</tr>
      
<tr>

<td class="tableaux1">anchor</td>
<td class="tableaux1">nameAtt</td>
<td class="tableaux1">the name of the name attribute</td>

</tr>
      
<tr>

<td class="tableaux2">anchor</td>
<td class="tableaux2">hrefAtt</td>
<td class="tableaux2">the name of the href attribute</td>

</tr>
      
<tr>

<td class="tableaux1">hiddenp, hiddendiv and stylespan</td>
<td class="tableaux1">styleAtt</td>
<td class="tableaux1">the name of the CSS style attribute</td>

</tr>
    
</table>
  
</div>
<div class="spacer"></div>
<hr>
<h1>Strings</h1>
<div class="zone_texte">
    
<p>All the texts (also called <em>strings</em>) may have to be changed in the interface created with the configuration. Either to improve readability without having to change the schema, or to provide an interface in another natural language for the same schema. Texts may also have to be provided for a set of languages, so that users can edit the same documents, with the same Daxe configuration, but with an interface entirely in their native language.</p>
    
<p>For these reasons, the <span class="code">Strings</span> element represents a set of strings for a given language and country, and it is possible to specify several in the same config file. On can use for instance <span class="code">language="pt" country="BR"</span> for Brazilian Portuguese, or just <span class="code">language="en"</span> so specify English without any precision about the country.</p>
    
<p>You may have noticed that the real config file XML elements have French names, even though you see them in English in Daxe and in this documentation. This is because the config file for config files is using these <span class="code">Strings</span> elements to define titles to use for elements when the user's system language is English.</p>
    
<div class="section_normale">
<h2>Element definition</h2>
      
<ul>
<li>

<span class="code">Configuration description</span>

<p>Short line to describe the configuration, displayed in the dialog to create new documents with Jaxe.</p>
        
</li>
<li>

<span class="code">Menu strings</span>

<p>Strings associated to a menu, identified with its name</p>
        
</li>
<li>

<span class="code">Title</span>

<p>A title</p>
        
</li>
<li>

<span class="code">Documentation</span>

<p>A documentation</p>
        
</li>
<li>

<span class="code">Element strings</span>

<p>Strings associated to an XML element. Used to display the element, but also for this element's insertion menu if no string was defined for the menu.</p>
        
</li>
<li>

<span class="code">Title for value</span>

<p>A title to use for an element or attribute value</p>
        
</li>
<li>

<span class="code">Attribute strings</span>

<p>Strings associated to an attributes</p>
        
</li>
</ul>
    
</div>
    
<div class="section_normale">
<h2>Element tree</h2>
      
<p>Element tree under <span class="code">Strings</span> :</p>
      
<ul>
<li>

<span class="code">Strings @language @country (Configuration description | Menu strings | Element strings)+</span>

<ul>
<li>

<span class="code">Configuration description</span>

</li>
<li>

<span class="code">Menu strings @menu (Title?, Documentation?, Menu strings*)</span>

<ul>
<li>

<span class="code">Title</span>

</li>
<li>

<span class="code">Documentation</span>

</li>
<li>

<span class="code">Menu strings @menu</span>

</li>
</ul>
            
</li>
<li>

<span class="code">Element strings @element (Title?, Documentation?, Title for value*, Attribute strings*)</span>

<ul>
<li>

<span class="code">Title</span>

</li>
<li>

<span class="code">Documentation</span>

</li>
<li>

<span class="code">Title for value @valeur</span>

</li>
<li>

<span class="code">Attribute strings @attribut (Title?, Documentation?, Title for value*)</span>

<ul>
<li>

<span class="code">Title</span>

</li>
<li>

<span class="code">Documentation</span>

</li>
<li>

<span class="code">Title for value @valeur</span>

</li>
</ul>
                
</li>
</ul>
            
</li>
</ul>
        
</li>
</ul>
    
</div>
  
</div>
<div class="spacer"></div>
<hr>
<div style="page-break-after: always"></div>
<h1>CMS integration</h1>
<hr>
<h1>Introduction</h1>
<div class="zone_texte">
    
<p>
      The Daxe web application needs to be integrated into a larger system to be able to save documents, as a web application does not have the rights to save a local file. Examples of integration include the <a target="_blank" class="lien" href="https://github.com/adopt/daxapp">Daxe desktop application</a> (written in Dart), <a target="_blank" class="lien" href="http://media4.obspm.fr/outils/webjaxe/en/">WebJaxe</a> (written in PHP) and <a target="_blank" class="lien" href="http://www.lon-capa.org/">LON-CAPA</a> (written in Perl).
    </p>
    
<p>
      In addition to a server-side processing of a request to save documents, servers should also provide directory listings with a specific format to let Daxe display a file chooser. This file chooser can be used to let users decide where to save an unsaved document, or to upload files used in the XML, such as image files.
    </p>
  
</div>
<div class="spacer"></div>
<hr>
<h1>Launching Daxe</h1>
<div class="zone_texte">
    
<p>
      The <span class="code">daxe</span> directory on the web server should simply be a copy of the <span class="code">web</span> directory after a build. These files are static and should be cached for better performance. The <span class="code">daxe.html</span> is used for debugging with <a target="_blank" class="lien" href="https://webdev.dartlang.org/tools/dartium">Dartium</a>, and can be removed in production. The file to launch is named <span class="code">daxe_js.html</span> after a build, and is usually renamed <span class="code">daxe.html</span> for simplicity.
    </p>
    
<p>
      Daxe is using the whole HTML document, using the URL to read parameters. It can be included in an iframe to fit inside a larger document.
    </p>
    
<p>
      The <span class="code">config</span> directory can be purged of configurations that are not used, although they will not cause additional requests if left there. The configuration files are the ones ending in <span class="code">_config.xml</span>, and they are often used with a schema file with a name ending in <span class="code">.xsd</span>.
    </p>
    
<p>
      The following parameters can be passed to the HTML file, as GET parameters. Paths can be relative to the HTML file.
    </p>
    
<div class="section_normale">
<h2>Parameters</h2>
      
<ul>
<li>

<span class="code">config</span>: the URL or path to the configuration file (required)</li>
<li>

<span class="code">file</span>: the URL or path to the file to be edited (optional, a new document is created if it is not specified)</li>
<li>

<span class="code">save</span>: the URL or path to the server script used to save a document (optional, the save menu does not appear if it is not specified)</li>
<li>

<span class="code">application</span>: should be <span class="code">true</span> for a desktop application (this adds the Open and Quit menus, and tells the server to quit at the end)</li>
</ul>
    
</div>
  
</div>
<div class="spacer"></div>
<hr>
<h1>Saving files</h1>
<div class="zone_texte">
    
<p>
      When a <span class="code">save</span> parameter is used to launch Daxe, a Save menu and toolbar button will appear.
    </p>
    
<p>
      Upon saving, the server receives a <em>multipart</em> POST request with the path of the document in the <span class="code">path</span> parameter and its content in the <span class="code">file</span> parameter. It replies with the text <span class="code">ok</span> if no error occured, or a string starting with <span class="code">error\n</span> if there was an error. An error message to display to the user can be included after <span class="code">error\n</span>.
    </p>
  
</div>
<div class="spacer"></div>
<hr>
<h1>Directory listing</h1>
<div class="zone_texte">
    
<p>
      To enable the file chooser in Daxe, the server simply has to return directory listings when a GET request to a directory is sent by the client. The returned content should be an XML file with the following syntax:
    </p>
    
<pre>
       &lt;directory name="current_dir"&gt;
          &lt;file name="example.txt" size="10" modified="2015-08-07T13:49:59"/&gt;
          &lt;directory name="sub_dir"/&gt;
        &lt;/directory&gt;
    </pre>
    
<p>
        The file size is in bytes. The modified timestamp is using ISO-8601.
    </p>
    
<p>
      To enable file uploads for the <span class="code">file</span> display type, the <span class="code">chooser</span> parameter should be set to <span class="code">true</span> in the configuration file. For instance, the whole element display for HTML's <span class="code">img</span> element would be:
    </p>
    
<pre>
      &lt;ELEMENT_DISPLAY element="img" type="file"&gt;
        &lt;PARAMETER name="srcAtt" value="src"/&gt;
        &lt;PARAMETER name="chooser" value="true"/&gt;
        &lt;PARAMETER name="widthAtt" value="width"/&gt;
        &lt;PARAMETER name="heightAtt" value="height"/&gt;
      &lt;/ELEMENT_DISPLAY&gt;
    </pre>
  
</div>
<div class="spacer"></div>
<hr>
<div style="page-break-after: always"></div>
<h1>Extending Daxe</h1>
<hr>
<h1>Introduction</h1>
<div class="zone_texte">
    
<p>
      XML editors which do not have knowledge of specific XML languages cannot provide a very good user interface. For instance, it would be hard to edit HTML documents if the <span class="code">p</span> (paragraph) and <span class="code">a</span> (anchor or link) elements from HTML were displayed in the same way. One is a block element, separating parts of the text, while the other is an inline element, which can be mixed with text. While some (usually data-oriented) XML languages can easily be edited with a tree, a tree user interface does not work so well with other XML languages.
    </p>
    
<p>
      On the other hand, creating a new editor from scratch for each XML language is not the most efficient solution, as at least half of the code will be the same from one editor to another. For instance, all editors have to ensure document validity, and they have to provide ways to edit content with a cursor aware of the XML structure. Common parts of XML editors should be reused.
    </p>
    
<p>
      Daxe is an answer to these questions: it provides all the building blocks for a new XML editor for a specific language, many predefined displays for elements which can be associated to the language XML elements, and ways to extend it further and include it into a larger application.
    </p>
    
<p>
      
<a class="lien" href="../pages_doc-config-en/intro-doc-config-en.html">Daxe configuration files</a> provide an easy way to customize the editor for a given XML language using built-in solutions. The following pages describe how to go beyond what can be done with configuration files, especially to create new display types.
    </p>
  
</div>
<div class="spacer"></div>
<hr>
<h1>Creating a new extension</h1>
<div class="zone_texte">
    
<p>
      An extension of Daxe has to be implemented in <a target="_blank" class="lien" href="https://www.dartlang.org/">Dart</a>, so the Dart SDK needs to be installed. Daxe's API documentation can be generated from the the source with the <a target="_blank" class="lien" href="https://github.com/dart-lang/dartdoc">dartdoc</a> command launched in the root of the source tree (the <span class="code">daxe</span> directory).
    </p>
    
<p>
      An extension is a Dart web application. Here is a basic example, adding a new display type named <span class="code">mydn</span> with the class <span class="code">MyDN</span>. This code would be in a file named <span class="code">my_daxe.dart</span>:
    </p>
    
<pre>
      library my_daxe;
      
      import 'package:daxe/daxe.dart';
      part 'my_dn.dart';
      
      void main() {
        NodeFactory.addCoreDisplayTypes();
        
        setDisplayType('mydn',
              (x.Element ref) =&gt; new MyDN.fromRef(ref),
              (x.Node node, DaxeNode parent) =&gt; new MyDN.fromNode(node, parent)
          );
      
        Strings.load().then((bool b) {
          initDaxe();
        }).catchError((e) {
          h.document.body.appendText('Error when loading the strings.');
        });
      }
    </pre>
  
</div>
<div class="spacer"></div>
<hr>
<h1>Creating new display types</h1>
<div class="zone_texte">
    
<p>
      A display type is defined by a class deriving from the <span class="code">DaxeNode</span> class in the <span class="code">daxe</span> package.
    </p>
    
<p>
      The implementation of the display type class needs 2 constructors, <span class="code">.fromRef()</span> to create a new instance from the language definition of the element, and <span class="code">.fromNode()</span>, to create a new instance from a DOM node. It also needs at least one method, <span class="code">html()</span>, which returns the DOM node for the node to display, with the node <span class="code">id</span>. As an example, let's look at the implementation for the <span class="code">string</span> display, which is simply an inline display with a start tag and an end tag:
    </p>
    
<pre>
      part of nodes;
      
      class DNString extends DaxeNode {
        Tag _b1, _b2;
        
        DNString.fromRef(x.Element elementRef) : super.fromRef(elementRef) {
          _b1 = new Tag(this, Tag.START);
          _b2 = new Tag(this, Tag.END);
        }
        
        DNString.fromNode(x.Node node, DaxeNode parent) : super.fromNode(node, parent) {
          _b1 = new Tag(this, Tag.START);
          _b2 = new Tag(this, Tag.END);
        }
        
        @override
        h.Element html() {
          var span = new h.SpanElement();
          span.id = "$id";
          span.classes.add('dn');
          if (!valid)
            span.classes.add('invalid');
          span.append(_b1.html());
          var contents = new h.SpanElement();
          DaxeNode dn = firstChild;
          while (dn != null) {
            contents.append(dn.html());
            dn = dn.nextSibling;
          }
          setStyle(contents);
          span.append(contents);
          span.append(_b2.html());
          return(span);
        }
        
        @override
        h.Element getHTMLContentsNode() {
          return(getHTMLNode().nodes[1]);
        }
      }
    </pre>
    
<p>
      The constructors derive from the <span class="code">fromRef()</span> and <span class="code">fromNode()</span> constructors in <span class="code">DaxeNode</span>, doing all the basic initialization for free. The start and end tags are created in the constructors, using the <span class="code">Tag</span> class. The <span class="code">html()</span> method creates a <span class="code">span</span> for the DOM node, sets the id based on <span class="code">DaxeNode.id</span>, adds an <span class="code">invalid</span> CSS class if necessary, and appends the tags' HTML nodes and the contents in another span. Style is applied to the contents with <span class="code">DaxeNode.setStyle()</span>, and the span is returned.
    </p>
    
<p>
      Another method is overridden, <span class="code">getHTMLContentsNode()</span>, to return the DOM node containing the children, which can be different depending on the implementation of <span class="code">html()</span>. In this case, we can simply return the second child of the node's DOM node, which we can get with <span class="code">DaxeNode.getHTMLNode()</span>.
    </p>
    
<p>
      While all display type classes have to derive from <span class="code">DaxeNode</span>, all the methods can be overridden, so these classes have complete control over appearance and resulting DOM, for the node itself and all the descendants.
    </p>
  
</div>
<div class="spacer"></div>
<hr>
<h1>More customization</h1>
<div class="zone_texte">
    
<p>
      Configuration files can be used to customize the menus used to insert nodes, but it is also possible to define menus with custom functions, and only a Daxe extension can implement these. It is also easy to customize the toolbar, the left panel, and the function used to save documents.
    </p>
    
<p>
      Function menus in configuration files are defined with a <span class="code">FUNCTION_MENU</span> element, and these have a <span class="code">function_name</span> attribute with the function name. This function can be added to Daxe in an extension with the <span class="code">addCustomFunction()</span> function in the <span class="code">daxe</span> package.
    </p>
    
<p>
      More customization can be done by passing named parameters to the <span class="code">initDaxe()</span> function:
    </p>
    
<ul>
<li>

<span class="code">left</span>: should be a <span class="code">LeftPanel</span> or a class deriving from it, representing the left panel</li>
<li>

<span class="code">saveFunction</span>: a function called when the document should be saved (by default, <span class="code">doc.save()</span>)</li>
<li>

<span class="code">customizeToolbar</span>: a function called at the right time to customize the toolbar (after <span class="code">page.toolbar</span> is created but before the HTML is generated)</li>
</ul>
    
<p>
      On top of that, more code can be executed after initialization, by using the fact that <span class="code">initDaxe()</span> returns a Future. Here is an example combining different customizations:
    </p>
    
<p>
      (Daxe's DOM package is included with <span class="code">import 'package:daxe/src/xmldom/xmldom.dart' as x;</span> in this example)
    </p>
    
<pre>
        // use a custom insert panel, MyOwnInsertPanel, implemented elsewhere
        InsertPanel insertP = new MyOwnInsertPanel();
        LeftPanel left = new LeftPanel(insert:insertP);
        ActionFunction saveFunction= () {
          // display an alert after a save
          doc.save().then((_) {
            h.window.alert(Strings.get('save.success'));
          }, onError: (DaxeException ex) {
            h.window.alert(Strings.get('save.error') + ': ' + ex.message);
          });
        };
        ActionFunction customizeToolbar = () {
          // add a button to insert a mydn node
          Toolbar toolbar = page.toolbar;
          List&lt;x.Element&gt; refs = doc.cfg.elementsWithType('mydn');
          if (refs != null &amp;&amp; refs.length &gt; 0) {
            ToolbarBox myBox = new ToolbarBox();
            toolbar.addInsertButton(doc.cfg, myBox, refs, 'my_dn.png');
            toolbar.add(myBox);
          }
        };
        Strings.load().then((bool b) {
          initDaxe(left:left, saveFunction:saveFunction,
              customizeToolbar:customizeToolbar).then((v) {
            // more customizations can be added here
          }).catchError((e) {
            String msg = 'Initialization error: ' + (e is String ? e : e.toString());
            print(msg);
            h.document.body.appendText(msg);
          });
        }).catchError((e) {
          String msg = 'Initialization error: ' + (e is String ? e : e.toString());
          print(msg);
          h.document.body.appendText(msg);
        });
    </pre>
    
<p>
      A large example of an extension is LON-CAPA Daxe, which lets LON-CAPA users edit documents using the LON-CAPA language, featuring a mix of HTML and custom elements for online problems. The source code is currently (as of 2017) available <a target="_blank" class="lien" href="http://source.lon-capa.org/cgi-bin/cvsweb.cgi/modules/damieng/graphical_editor/loncapa_daxe/">here</a>.
    </p>
  
</div>
<div class="spacer"></div>
</body>
</html>
